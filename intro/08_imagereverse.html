<html>
  <style>
    canvas {
        max-width:45%;
    }
  </style>
  <body>
    <canvas> </canvas>
    <canvas> </canvas>
    <script src="lib/imageinput.js"> </script>
    <script>
      const [srcCanvas, dstCanvas] = document.querySelectorAll('canvas');
      imageinput(srcCanvas, (image) => {
          reverseImage(srcCanvas, dstCanvas);
      });
      const reverseImage = (srcCanvas, dstCanvas) => {
          const { width , height } = srcCanvas;
          dstCanvas.width = width;
          dstCanvas.height = height;
          const srcCtx = srcCanvas.getContext('2d');
          const dstCtx = dstCanvas.getContext('2d');
          const srcImageData = srcCtx.getImageData(0, 0, width, height);
          const dstImageData = new ImageData(width, height);
          // dstImageData.data.set(srcImageData.data.reverse()); // NG
          // const srcData32 = new Uint32Array(srcImageData.data.buffer)
          // const dstData32 = new Uint32Array(dstImageData.data.buffer);
          // dstData32.set(srcData32.reverse()); // copy array all
          for (let i = 0; i < width * height; i++) {
              let rgba = srcImageData.data.subarray(i*4, i*4 + 4);
              dstImageData.data.set(rgba, (width * height - i - 1)*4);
          }
          dstCtx.putImageData(dstImageData, 0, 0);
      }
    </script>
  </body>
</html>
